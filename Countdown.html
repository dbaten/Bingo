<!DOCTYPE html>
<html>
	<head>
    <title>Bingo Countdown</title>
		<style>
			h1 {text-align: center;
			font-size: 150px;}
			button {text-align: center;
			font-size: 30px;}
			body {
			background-color: lightblue;
			}
		</style>
  </head>
  <html>
<p></p>
<h1 id="timerText" > WAITING </h1>
<p></p>
<button type="button" onclick="startTimer(60)">1 Minute</button>
<button type="button" onclick="startTimer(90)">1 Minute and a half</button>
<button type="button" onclick="startTimer(120)">2 Minutes Fast</button>
<button type="button" onclick="startTimer(119)">2 Minutes Slow</button>
<button type="button" onclick="startTimer(300)">5 Minutes</button>

<audio id="OneTwenty">
  <source src="Two_Minutes.ogg" type="audio/ogg">
  Your browser does not support the audio element.
</audio>

<audio id="SlowOneTwenty">
  <source src="Slow_Two_Minutes.ogg" type="audio/ogg">
  Your browser does not support the audio element.
</audio>

<audio id="OneMinute">
  <source src="OneMinute.ogg" type="audio/ogg">
  Your browser does not support the audio element.
</audio>

<audio id="FiveMinutes">
  <source src="FiveMinutes.ogg" type="audio/ogg">
  Your browser does not support the audio element.
</audio>

<audio id="Ninety">
  <source src="NinetySeconds.ogg" type="audio/ogg">
  Your browser does not support the audio element.
</audio>

<audio id="Tada">
  <source src="Tada.ogg" type="audio/ogg">
  Your browser does not support the audio element.
</audio>


<script>
//////////// Script begin /////////////////////////

////////////////////////////////////////
// Variables
const SECOND = 1000;
// States
const WAITING_FOR_COUNTDOWN = 0;
const BEGIN                 = 1;
const COUNTING_DOWN         = 2;
const RUNNING_TIMER         = 3;
const TIMER_EXPIRED         = 4;

const BLINKING_OFF          = 0;
const BLINKING_ON           = 1;

blinkingState =BLINKING_OFF;
countdownState=WAITING_FOR_COUNTDOWN;
blinkingTimer = 0;
var countdownTimer = 0;
var preTimer = 0;

function displayTimer(timer){

	   var totalSeconds = timer / SECOND;
	   var minutes = parseInt(totalSeconds / 60);
	   var seconds = totalSeconds - (minutes * 60);

       if (seconds < 10)
          textArea.innerHTML = minutes+":0"+seconds;
	   else
          textArea.innerHTML = minutes+":"+seconds;
	   
}

function playSound(seconds){
  switch (seconds/SECOND){
      case 60 :
        OneMinute.play(); 
        break;
      case 90 :
        Ninety_Seconds.play(); 
        break;
      case 300 :
        FiveMinutes.play();
        break;
      case 119:
        SlowOneTwenty.play();
        break;
      case 120:
        OneTwenty.play();
        break;
      default :
        break;
  }
}
function checkTimeout() {

   switch(countdownState) {
     case WAITING_FOR_COUNTDOWN:
       textArea.innerHTML = 'wait';
       countdownState = BEGIN;
       break;
     case COUNTING_DOWN:
	     preTimer-=SECOND;

       displayTimer(preTimer);
	     if (preTimer < 2000){
           countdownState = BEGIN;
	     }
       break;

     case BEGIN:
       textArea.innerHTML = 'BEGIN';
       countdownState = RUNNING_TIMER;
       playSound(countdownTimer);
       break;
	 case RUNNING_TIMER:
	   countdownTimer-=SECOND;

       displayTimer(countdownTimer);
	     if (countdownTimer < 2000){
           countdownState = TIMER_EXPIRED;
           Tada.play();
	     }
	   break;
	 case TIMER_EXPIRED:
       if (blinkingTimer == BLINKING_ON) {
           textArea.innerHTML = "!!You're Done!!";
           blinkingTimer = BLINKING_OFF;
       }
       else
       {
           textArea.innerHTML = "  You're Done  ";
           blinkingTimer = BLINKING_ON;
       }
   default:
   }

   // wait one second for the next tick
   setTimeout(checkTimeout, 1000);
}

function startTimer(seconds){
	countdownState = seconds * SECOND;
	blinkingTimer = BLINKING_ON;
	preTimer = 5 * SECOND;
	countdownTimer = seconds * SECOND;

	countdownState = COUNTING_DOWN;

  checkTimeout();
}

var textArea       = document.getElementById('timerText');
var debugTextArea  = document.getElementById('debugText');

var OneTwenty      = document.getElementById("OneTwenty"); 
var Ninety_Seconds = document.getElementById("Ninety"); 

textArea.innerHTML = 'Waiting';
</script>

</body>
</html>
