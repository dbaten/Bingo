<!DOCTYPE html>
<html>
<head>
<title>BINGO</title>
<style>
body {
  text-align:center; 
  vertical-align:middle; 
  font-weight:bold; 
  font-size:1.2em;
  }
  table {
    width:100%;
  }
  th {
    background-color: #555;
    color: #fff;
  }
  tr { 
    height:62px;
  }
  .Type01 {
    background-color: #fff;
    color: #000;
  }
  .Type02 {
    background-color: #0f0;
    color: #000;
  }
  .Type03 {
    background-color: #f00;
    color: #000;
  }
  .Prior {
  	background-color: #59e6e6;
  	color: #000;
  }
  .Last {
  	background-color: #f77c40;
  	color: #000;
  }
  button {
    width: 100%; 
    height: 58px;
    font-size:larger;
    font-weight:  bold;
  }	
	button:only-of-type:hover {
	  	border-style: dotted;
		border-block-color: red;
		border-width: thick;
		/* background-color: #6600ff;
		color: #000; */
	}  
.btn-group button {
  background-color: #c6d8c7; /* Green background */
  border: 1px solid green; /* Green border */
  color: white; /* White text */
  padding: 10px 24px; /* Some padding */
  cursor: pointer; /* Pointer/hand icon */
  float: left; /* Float the buttons side by side */
}

/* Clear floats (clearfix hack) */
.btn-group:after {
  content: "";
  clear: both;
  display: table;
}

.btn-group button:not(:last-child) {
  border-right: none; /* Prevent double borders */
}

/* Add a background color on hover */
.btn-group button:hover {
  background-color: #3e8e41;
}	
</style>
<script language="javascript">
	priorElement = "";
	prior2Elem = "";
	
	function Clicked(elementID) {
		if(priorElement != elementID && priorElement != "") {
  			document.getElementById(priorElement).className = "Prior";
	    }
	  	console.log(elementID.substr(1));
	  	if (document.getElementById(elementID).classList.contains('Type01')) {	  	
			if(prior2Elem != elementID && prior2Elem != "") {
		  		document.getElementById(prior2Elem).className = "Type02";
	  		}
		  	prior2Elem = priorElement;
	    	priorElement = elementID;
	  		document.getElementById(elementID).className = "Last";	  		
	    }
	    else if (document.getElementById(elementID).classList.contains('Type02')) {
	  		document.getElementById(elementID).className = "Type03";
	  	}
	    else if (document.getElementById(elementID).classList.contains('Type03')) {
	  		document.getElementById(elementID).className = "Type01";
	      priorElement = ""
	  	}
  	}

	function pageLoaded() {
  		loadLang();
	}
</script>
</head>
<body onload="pageLoaded()">
<table>
	<colgroup>
		<col style="width:10%">
		<col style="width:10%">
		<col style="width:10%">
		<col style="width:10%">
		<col style="width:10%">
		<col style="width:10%">
		<col style="width:10%">
		<col style="width:10%">
		<col style="width:10%">
	</colgroup>
	<tr>
		<th>0s</th>
		<th>10s</th>
		<th>20s</th>
		<th>30s</th>
		<th>40s</th>
		<th>50s</th>
		<th>60s</th>
		<th>70s</th>
		<th>80s</th>
	</tr>
	<tr>
		<td><button id="f01" class="Type01" onclick='Clicked("f01")'>01</button></td>
    	<td><button id="f11" class="Type01" onclick='Clicked("f11")'>11</button></td>
		<td><button id="f21" class="Type01" onclick='Clicked("f21")'>21</button></td>
		<td><button id="f31" class="Type01" onclick='Clicked("f31")'>31</button></td>
		<td><button id="f41" class="Type01" onclick='Clicked("f41")'>41</button></td>
		<td><button id="f51" class="Type01" onclick='Clicked("f51")'>51</button></td>
		<td><button id="f61" class="Type01" onclick='Clicked("f61")'>61</button></td>
		<td><button id="f71" class="Type01" onclick='Clicked("f71")'>71</button></td>
		<td><button id="f81" class="Type01" onclick='Clicked("f81")'>81</button></td>
	</tr>
	<tr>
		<td><button id="f02" class="Type01" onclick='Clicked("f02")'>02</button></td>
    	<td><button id="f12" class="Type01" onclick='Clicked("f12")'>12</button></td>
		<td><button id="f22" class="Type01" onclick='Clicked("f22")'>22</button></td>
		<td><button id="f32" class="Type01" onclick='Clicked("f32")'>32</button></td>
		<td><button id="f42" class="Type01" onclick='Clicked("f42")'>42</button></td>
		<td><button id="f52" class="Type01" onclick='Clicked("f52")'>52</button></td>
		<td><button id="f62" class="Type01" onclick='Clicked("f62")'>62</button></td>
		<td><button id="f72" class="Type01" onclick='Clicked("f72")'>72</button></td>
		<td><button id="f82" class="Type01" onclick='Clicked("f82")'>82</button></td>
	</tr>
	<tr>
		<td><button id="f03" class="Type01" onclick='Clicked("f03")'>03</button></td>
    	<td><button id="f13" class="Type01" onclick='Clicked("f13")'>13</button></td>
		<td><button id="f23" class="Type01" onclick='Clicked("f23")'>23</button></td>
		<td><button id="f33" class="Type01" onclick='Clicked("f33")'>33</button></td>
		<td><button id="f43" class="Type01" onclick='Clicked("f43")'>43</button></td>
		<td><button id="f53" class="Type01" onclick='Clicked("f53")'>53</button></td>
		<td><button id="f63" class="Type01" onclick='Clicked("f63")'>63</button></td>
		<td><button id="f73" class="Type01" onclick='Clicked("f73")'>73</button></td>
		<td><button id="f83" class="Type01" onclick='Clicked("f83")'>83</button></td>
	</tr>
	<tr>
		<td><button id="f04" class="Type01" onclick='Clicked("f04")'>04</button></td>
    	<td><button id="f14" class="Type01" onclick='Clicked("f14")'>14</button></td>
		<td><button id="f24" class="Type01" onclick='Clicked("f24")'>24</button></td>
		<td><button id="f34" class="Type01" onclick='Clicked("f34")'>34</button></td>
		<td><button id="f44" class="Type01" onclick='Clicked("f44")'>44</button></td>
		<td><button id="f54" class="Type01" onclick='Clicked("f54")'>54</button></td>
		<td><button id="f64" class="Type01" onclick='Clicked("f64")'>64</button></td>
		<td><button id="f74" class="Type01" onclick='Clicked("f74")'>74</button></td>
		<td><button id="f84" class="Type01" onclick='Clicked("f84")'>84</button></td>
	</tr>
	<tr>
		<td><button id="f05" class="Type01" onclick='Clicked("f05")'>05</button></td>
    	<td><button id="f15" class="Type01" onclick='Clicked("f15")'>15</button></td>
		<td><button id="f25" class="Type01" onclick='Clicked("f25")'>25</button></td>
		<td><button id="f35" class="Type01" onclick='Clicked("f35")'>35</button></td>
		<td><button id="f45" class="Type01" onclick='Clicked("f45")'>45</button></td>
		<td><button id="f55" class="Type01" onclick='Clicked("f55")'>55</button></td>
		<td><button id="f65" class="Type01" onclick='Clicked("f65")'>65</button></td>
		<td><button id="f75" class="Type01" onclick='Clicked("f75")'>75</button></td>
		<td><button id="f85" class="Type01" onclick='Clicked("f85")'>85</button></td>
	</tr>
	<tr>
		<td><button id="f06" class="Type01" onclick='Clicked("f06")'>06</button></td>
    	<td><button id="f16" class="Type01" onclick='Clicked("f16")'>16</button></td>
		<td><button id="f26" class="Type01" onclick='Clicked("f26")'>26</button></td>
		<td><button id="f36" class="Type01" onclick='Clicked("f36")'>36</button></td>
		<td><button id="f46" class="Type01" onclick='Clicked("f46")'>46</button></td>
		<td><button id="f56" class="Type01" onclick='Clicked("f56")'>56</button></td>
		<td><button id="f66" class="Type01" onclick='Clicked("f66")'>66</button></td>
		<td><button id="f76" class="Type01" onclick='Clicked("f76")'>76</button></td>
		<td><button id="f86" class="Type01" onclick='Clicked("f86")'>86</button></td>
	</tr>
	<tr>
		<td><button id="f07" class="Type01" onclick='Clicked("f07")'>07</button></td>
    	<td><button id="f17" class="Type01" onclick='Clicked("f17")'>17</button></td>
		<td><button id="f27" class="Type01" onclick='Clicked("f27")'>27</button></td>
		<td><button id="f37" class="Type01" onclick='Clicked("f37")'>37</button></td>
		<td><button id="f47" class="Type01" onclick='Clicked("f47")'>47</button></td>
		<td><button id="f57" class="Type01" onclick='Clicked("f57")'>57</button></td>
		<td><button id="f67" class="Type01" onclick='Clicked("f67")'>67</button></td>
		<td><button id="f77" class="Type01" onclick='Clicked("f77")'>77</button></td>
		<td><button id="f87" class="Type01" onclick='Clicked("f87")'>87</button></td>
	</tr>
	<tr>
		<td><button id="f08" class="Type01" onclick='Clicked("f08")'>08</button></td>
    	<td><button id="f18" class="Type01" onclick='Clicked("f18")'>18</button></td>
		<td><button id="f28" class="Type01" onclick='Clicked("f28")'>28</button></td>
		<td><button id="f38" class="Type01" onclick='Clicked("f38")'>38</button></td>
		<td><button id="f48" class="Type01" onclick='Clicked("f48")'>48</button></td>
		<td><button id="f58" class="Type01" onclick='Clicked("f58")'>58</button></td>
		<td><button id="f68" class="Type01" onclick='Clicked("f68")'>68</button></td>
		<td><button id="f78" class="Type01" onclick='Clicked("f78")'>78</button></td>
		<td><button id="f88" class="Type01" onclick='Clicked("f88")'>88</button></td>
	</tr>
	<tr>
		<td><button id="f09" class="Type01" onclick='Clicked("f09")'>09</button></td>
    	<td><button id="f19" class="Type01" onclick='Clicked("f19")'>19</button></td>
		<td><button id="f29" class="Type01" onclick='Clicked("f29")'>29</button></td>
		<td><button id="f39" class="Type01" onclick='Clicked("f39")'>39</button></td>
		<td><button id="f49" class="Type01" onclick='Clicked("f49")'>49</button></td>
		<td><button id="f59" class="Type01" onclick='Clicked("f59")'>59</button></td>
		<td><button id="f69" class="Type01" onclick='Clicked("f69")'>69</button></td>
		<td><button id="f79" class="Type01" onclick='Clicked("f79")'>79</button></td>
		<td><button id="f89" class="Type01" onclick='Clicked("f89")'>89</button></td>
	</tr>
	<tr>
		<td><button id="f10" class="Type01" onclick='Clicked("f10")'>10</button></td>
    	<td><button id="f20" class="Type01" onclick='Clicked("f20")'>20</button></td>
		<td><button id="f30" class="Type01" onclick='Clicked("f30")'>30</button></td>
		<td><button id="f40" class="Type01" onclick='Clicked("f40")'>40</button></td>
		<td><button id="f50" class="Type01" onclick='Clicked("f50")'>50</button></td>
		<td><button id="f60" class="Type01" onclick='Clicked("f60")'>60</button></td>
		<td><button id="f70" class="Type01" onclick='Clicked("f70")'>70</button></td>
		<td><button id="f80" class="Type01" onclick='Clicked("f80")'>80</button></td>
		<td><button id="f90" class="Type01" onclick='Clicked("f90")'>90</button></td>
	</tr>
</table>
<table>
	<colgroup>
		<col style="width:10%">
		<col style="width:10%; font-size:larger ">
	</colgroup>
	<tr>
		<td><button class="btn-group" onclick='onHitMe()'>Hit Me</button></td>
		<td><button id="currentBall" class="btn-group" > -- </button></td>
	</tr>
</table>
<table>
	<tr>
		<td>
			<button name="loadLang" id="loadLangId" style="width: 80px; height: 35px; font-size: 0.9em; padding-left: 2px;" onclick='loadLang()'>Load</button>
			<label for="language">Lang:</label>
  			<select name="language" id="languageId">
				<option value="1">1</option>
  			</select>
			<label for="auto">Auto:</label>
  			<select name="auto" id="autoId">
				<option value="7">7</option>
				<option value="8">8</option>
				<option value="9" selected="selected">9</option>
				<option value="10">10</option>
				<option value="12">12</option>
				<option value="15">15</option>
  			</select>
			<button name="autoRun" id="autoRunId" style="width: 150px; height: 35px;" onclick='onAutoRun()'>Auto</button>
		</td>
	</tr>
</table>
	
<script>

	MAXBALLS=90;
	MAXTRIALS=500;
    var balls = [];
	currentBall = 0;
	//var supportedLanguages = [0,1,3,4,5];
	var supportedLanguages = [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20];

//	var voices = window.speechSynthesis.getVoices();
//	maxVoices = supportedLanguages.length;
//	fillLanguageDropdown(maxVoices, 1);
	
	var numDoubles = 0;

	for (ball=0; ball < MAXBALLS; ball++){
		balls[ball] = ball + 1;
	}

	for (trial=0; trial < MAXTRIALS; trial++){
		for (ball=0; ball < MAXBALLS; ball++){
			ballToSwap = parseInt(Math.random()*MAXBALLS);
			swap(ball, ballToSwap);			
		}
	}

	speak("Let's play bingo");
	speak("woohoo");
	
	// States
	const MANUAL = 0;
	const AUTO   = 1;
	var runState = MANUAL;
	var secondsOfTimeout = 1;

	function gotADouble(number){
		numDoubles++;

        if (number !=55 && number != 11){
			if (numDoubles == 2) {
				speak("Another Double");
			}
			else if (numDoubles == 3 ) {
				speak("Yet Another Double");
			}
			else if (numDoubles == 1 ) {
				speak("Got a Double");
			}
		}
	}
	
	function swap(first, second){
		temp = balls[first];
		balls[first] = balls[second];
		balls[second] = temp;
	}

	function paintTile(tileToPaint){
		if (tileToPaint < 10){
			id = "f0" + tileToPaint;
		}
		else {
			id = "f" + tileToPaint;
		}
		Clicked(id);
	}
	
	function loadLang(message){
		speak("Welcome to Bingo");
		document.getElementById("loadLangId").style.display = "none";
	}
	
	function speak(message){
		console.log("speak " + message);
		
		var currentLang = document.getElementById("languageId").value
		if (isNaN(currentLang) || currentLang == undefined || currentLang == "") {
			currentLang = 1;
		}
		var voices = window.speechSynthesis.getVoices();
		maxVoices = supportedLanguages.length;
		fillLanguageDropdown(voices, currentLang);
	
		var msg=new SpeechSynthesisUtterance(message);

		msg.voice = voices[document.getElementById("languageId").value];
		window.speechSynthesis.speak(msg);
	}

	function speakOne(option1, option2){

		if (Math.random() > 0.5 ){
			speak(option1);
		}
		else {
			speak(option2);
		}
	}

	function speakNumber(number){

		tens = parseInt(number / 10);
		ones = number - (10 * tens);

		if (tens == ones){
			gotADouble(number);
		}

		trailMessage = "";

    	switch (number){
			case 88:
				speak("crazy eights 88");
				break;
			case 76:
				speakOne("76 trombones","the spirit of 76");
				break;
			case 71:
				speak("s r 71");
				break;
			case 57:
				speakOne("heinz 57","57 chevy");
				break;
			case 56:
				trailMessage = "pickup sticks";
				break
			case 55:
				speak("double Nickel 55");
				break;
			case 54:
				speak("car 54 where are you");
				break;
			case 51:
				speak("area 51");
				break;
			case 50:
				speak("hawaii 5 0");
				break;
			case 34:
				trailMessage = "shut the door";
				break;
			case 31:
				speak("31 flavors");
				break;
			case 21:
				speak("blackjack 21");
				break;
			case 19:
				speakOne("hey 19 ","Nah Nah Nah Nah, 19");
				break;
			case 17:
				speak("17, ah, gain ");
				break;
			case 16:
				speak("sweet 16");
				break;
			case 13:
				speak("lucky number 13");
				break;
			case 11:
				speak("chicken legs 11");
				break;
			case 9:
				speak("number 9");
				speak("number 9");
				speak("number 9");
				break;
			case 8:
				speak("8,, the ocho");
				break;
			case 7:
				speak("lucky number 7");
				break;
			case 4:
				speak("quatro 4");
				break;
			case 2:
				speak("the deuce");
				break;
			case 1:
				speak("Uno ");
				break;
			default:
				speak(number);
		}

        if (tens == 0){
			tens = "zero";
		}

		if (ones == 0){
			speak ("thats "+ tens+ "zero");
		} else {
			speak(tens+" "+ones+ trailMessage);
		}
	}
	
	function onHitMe() {
		// put the number in the output
		document.getElementById("currentBall").innerHTML = balls[currentBall];

		// paint the tile
		paintTile(balls[currentBall]);

		// speak out the number
		speakNumber(balls[currentBall]);
        currentBall++;
	}
	
	function fillLanguageDropdown(voices, defaultVoice){
		// clear dropdown
		var select = document.getElementById("languageId");
		var length = select.options.length;
		for (i = length-1; i >= 0; i--) {
			select.options[i] = null;
		}
		// fill dropdown
		for(var i = 0; i < voices.length; i++) {
    		var option = document.createElement('option');
    		option.textContent = voices[i].name + ' (' + voices[i].lang + ')';
    		
    		if(voices[i].default) {
      			option.textContent += ' -- DEFAULT';
    		}
		
    		option.setAttribute('data-lang', voices[i].lang);
    		option.setAttribute('data-name', voices[i].name);
			var name = voices[i].name;

			if (name.includes("UK")) {
				if (name.includes("Female")){
		            defaultVoice = i;
				}
			}
    		option.value = i;
    		//document.getElementById("voiceSelect").appendChild(option);
			select.appendChild(option);
  		}
  		/*
		for(var i = 0; i < maxVoices; i++) {
			var el = document.createElement("option");
			el.textContent = i;
			el.value = i;
			//if (i == defaultVoice){
			//	el.selected = true;
			//}
			select.appendChild(el);
		}
		*/
		document.getElementById("languageId").value = new String(defaultVoice);
		console.log("language is " + document.getElementById("languageId").value);
	}
	
	function onAutoRun(){
		if (runState == MANUAL){
			console.log("starting auto");
			runState = AUTO;

			// wait one second for the next tick
			secondsOfTimeout = 1;
			timeoutValue = document.getElementById("autoId").value;
			document.querySelector('#autoRunId').innerHTML = 'Stop '+secondsOfTimeout+"/"+timeoutValue;
			setTimeout(autoTimeout, 1000 );
		}
		else {
			console.log("stopping auto");
			document.querySelector('#autoRunId').innerHTML = 'Auto';
			runState = MANUAL;
		}
	}
	
	function autoTimeout(){
		if (runState == AUTO){		
			secondsOfTimeout++;
			timeoutValue = document.getElementById("autoId").value;
			if (secondsOfTimeout > timeoutValue){
				onHitMe();
				secondsOfTimeout=1;
			}
			document.querySelector('#autoRunId').innerHTML = 'Stop '+secondsOfTimeout+"/"+timeoutValue;
			
			// wait one second for the next tick
			//setTimeout(autoTimeout, 1000 * document.getElementById("autoId").value);
			setTimeout(autoTimeout, 1000 );
		}
	}
	
</script>
</body>
</html>
